import librosa
import soundfile
import numpy as np
from datetime import datetime

def add_new_note(song, note, sample_idx):
    if sample_idx > len(song): # Add a note after the end of the song.  Pad the extra space with zeros.
        song = np.concat( (song,  np.zeros(sample_idx  - len(song)), note ))
        return song
    elif sample_idx + len(note) > len(song): # Add a note overlapping the end of the song
        len_result = sample_idx + len(note)
        padded_note = np.concat( (np.zeros(sample_idx), note) )
        padded_song = np.concat( (song, np.zeros(len_result - len(song))) )
        return padded_song + padded_note
    else:   # Add a note that ends before the end of the song
        start_of_note = sample_idx
        end_of_note = sample_idx + len(note)
        padded_note = np.concat( (np.zeros(start_of_note), note, np.zeros(len(song) - end_of_note)))
        return padded_note + song

def make_song_from_array(notes, song_array, samples_between_notes):
    #song_array = [[0, 12, 400, 400, 7, 7]] # rest for undefined notes
    sound_signal = notes[0][0:1]
    for score in song_array:
        sample_idx = 0
        for note_idx in range(len(score)):
            this_note_obj = score[note_idx]

            if isinstance(this_note_obj, int):  # simple note
                note_value = this_note_obj + zero_note
            elif isinstance(this_note_obj, list):   #note that may be of a different length than a simple note
                note_value = this_note_obj[0] + zero_note

            if note_value in notes:
                sound_signal = add_new_note(sound_signal, notes[note_value], sample_idx)
            else:
                sound_signal = add_new_note(sound_signal, 0*notes[0], sample_idx) # rest if there is no note defined

            if isinstance(this_note_obj, int):  # simple note
                sample_idx = sample_idx + int(samples_between_notes)
            elif isinstance(this_note_obj, list):   #note that may be of a different length than a simple note
                sample_idx = sample_idx + int(samples_between_notes * this_note_obj[1])
    return sound_signal

note, sample_rate = librosa.load('sound_test/piano_fsharp.mp3')
note = note[0:len(note)] #trim off quiet following the note
num_notes_lower = 37
num_notes_higher = 13
first_note = 0
last_note = num_notes_lower + num_notes_higher - 1

time_between_notes = 0.5  # you can choose the shortest note (e.g. an eighth note) to avoid fractions in the song array,
                            # though it's not required
zero_note = 20

samples_between_notes = time_between_notes * sample_rate

notes = {}
for note_int in range(-1*num_notes_lower, num_notes_higher):
    scaled_note= librosa.effects.pitch_shift(y=note, sr=sample_rate, bins_per_octave=12, n_steps=note_int, scale=True)
    notes[note_int + num_notes_lower] = scaled_note

# song_array = [[0, 2, 4, 5, 7, 9, 11, 12], [2, 4, 5, 7, 9, 11, 12, 14], [4, 5, 7, 9, 11, 12, 14, 16]]  # do re mi, plus friends
song_array = [
    [0, 0, [5,2], 5, 7, 9, 5,  #Tis a gift to be simple,
     9, 10, [12,2], 12, 10, [9,2],  # Tis a gift to be free.
     7, 5, [7,2], [7,2], [7,2], [5,2], 7, 9, 7, 4, [0,2], # Tis a gift to come down where we ought to be,
     [0,2], 5, 4, 5, 7, [9,2], 7, 7, [9,2], [10,2], [12,2], # and when we find ourselves in the place just right,
     [9,2], [7,2], 7, 7, 9, [9,2], 7, [5,2], 5, 5, [5,4], # t'will be in the valley of love and delight.
     [12,4], [9,3], 7, 9, 10, 9, 7, [5,3], # When true simplicity is gained,
     7, [9,2], 9, 10, [12,2], [9,2], [7,2], 7, 9, [7,2], #to bow and to bend we shan't be ashamed.
     [0,2], [5,4], [5,3], 7, [9,2], 9, 10, [12,2], # To turn, turn, will be our delight,
     10, 9, [7,2], [7,2], [9,2], 9, 7, [5,2], [5,2], [5,4]], # till by turning, turning we come out right.
     []
     ]

# begin midi experiment ----------------------------

song_array = [[], [[76, 0.08], [75, 0.12], [76, 0.0], [75, 0.12], [76, 0.04], [71, 0.0], [74, 0.12], [72, 0.04], [69, 0.04], [60, 1.64], [64, 0.04], [69, 0.0], [71, 0.08], [64, 2.0], [68, 0.08], [71, 0.12], [72, 0.0], [64, 2.0], [76, 0.08], [75, 0.12], [76, 0.04], [75, 0.04], [76, 0.04], [71, 0.0], [74, 0.12], [72, 0.0], [69, 0.08], [60, 2.04], [64, 0.04], [69, 0.04], [71, 0.0], [62, 0.12], [72, 1.92], [71, 0.04], [69, 0.0], [60, 0.0], [76, 3.96], [75, 0.04], [76, 0.04], [75, 0.04], [76, 0.0], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.0], [60, 2.04], [64, 0.0], [69, 0.08], [71, 0.12], [64, 1.96], [68, 0.04], [71, 0.04], [72, 0.04], [64, 1.96], [76, 0.0], [75, 0.08], [76, 0.12], [75, 0.04], [76, 0.0], [71, 0.12], [74, 0.0], [72, 0.12], [69, 0.04], [60, 1.92], [64, 0.08], [69, 0.08], [71, 0.12], [62, 1.96], [72, 1.88], [71, 0.08], [69, 0.0], [60, 0.04], [71, 1.96], [72, 0.0], [74, 0.12], [76, 0.0], [67, 0.08], [77, 0.08], [76, 0.08], [74, 0.12], [65, 0.04], [76, 0.04], [74, 0.04], [72, 0.0], [64, 0.08], [74, 0.08], [72, 0.12], [71, 0.0], [64, 3.96], [76, 0.04], [76, 3.88], [88, 0.04], [75, 2.24], [76, 0.12], [75, 3.84], [76, 0.12], [75, 0.04], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.04], [74, 0.04], [72, 0.0], [69, 0.08], [60, 2.0], [64, 0.08], [69, 0.08], [71, 0.12], [64, 1.96], [68, 0.0], [71, 0.12], [72, 0.04], [64, 1.96], [76, 0.0], [75, 0.12], [76, 0.04], [75, 0.0], [76, 0.12], [71, 0.0], [74, 0.12], [72, 0.04], [69, 0.04], [60, 1.92], [64, 0.08], [69, 0.12], [71, 0.0], [62, 2.0], [72, 1.92], [71, 0.12], [69, 0.04], [60, 0.0], [71, 1.92], [72, 0.08], [74, 0.08], [76, 0.08], [67, 0.08], [77, 0.08], [76, 0.12], [74, 0.0], [65, 0.12], [76, 0.04], [74, 0.04], [72, 0.0], [64, 0.12], [74, 0.0], [72, 0.08], [71, 0.12], [64, 2.92], [76, 0.96], [76, 3.96], [88, 1.0], [75, 2.84], [76, 1.04], [75, 3.92], [76, 1.08], [75, 0.0], [76, 1.08], [75, 0.0], [76, 0.12], [71, 0.0], [74, 0.08], [72, 0.12], [69, 0.96], [60, 2.84], [64, 0.12], [69, 0.0], [71, 0.08], [64, 2.0], [68, 0.08], [71, 0.12], [72, 0.04], [64, 1.96], [76, 1.0], [75, 0.04], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.04], [74, 0.04], [72, 0.0], [69, 0.08], [60, 3.0], [64, 0.0], [69, 0.08], [71, 0.08], [62, 2.04], [72, 0.04], [71, 0.04], [69, 0.96], [60, 0.04], [72, 2.92], [64, 0.0], [65, 0.96], [72, 0.04], [72, 0.96], [64, 0.04], [67, 0.0], [72, 0.96], [77, 1.08], [76, 0.04], [76, 0.04], [74, 0.0], [82, 1.04], [81, 0.12], [81, 0.04], [79, 0.0], [77, 0.08], [76, 0.08], [74, 0.12], [72, 0.0], [70, 0.08], [69, 0.12], [70, 0.04], [69, 0.04], [67, 0.04], [69, 0.0], [70, 0.12], [72, 0.0], [74, 0.12], [75, 0.04], [76, 0.04], [76, 1.0], [77, 0.0], [69, 0.08], [72, 1.04], [74, 1.08], [72, 0.04], [71, 0.04], [72, 0.0], [74, 0.08], [71, 0.08], [72, 0.12], [79, 0.0], [67, 0.12], [79, 0.04], [69, 0.04], [79, 0.0], [71, 0.08], [79, 0.12], [72, 0.0], [79, 0.12], [74, 0.0], [79, 0.08], [76, 0.08], [79, 0.12], [84, 0.0], [83, 0.12], [81, 0.04], [79, 0.0], [77, 0.08], [76, 0.12], [74, 0.04], [79, 0.0], [77, 0.08], [74, 0.12], [72, 0.04], [79, 0.04], [67, 0.04], [79, 0.04], [69, 0.0], [79, 0.12], [71, 0.04], [79, 0.0], [72, 0.08], [79, 0.08], [74, 0.08], [79, 0.12], [76, 0.04], [79, 0.04], [84, 0.04], [83, 0.04], [81, 0.0], [79, 0.12], [77, 0.0], [76, 0.08], [74, 0.08], [79, 0.12], [77, 0.0], [74, 0.12], [76, 0.0], [77, 0.12], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.04], [76, 0.04], [75, 0.04], [76, 0.04], [71, 0.0], [76, 0.12], [75, 0.04], [76, 0.0], [71, 0.08], [76, 0.12], [75, 0.04], [76, 0.0], [71, 0.08], [76, 0.08], [75, 1.72], [76, 0.0], [75, 3.92], [76, 0.12], [75, 0.0], [76, 0.08], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.0], [60, 2.04], [64, 0.04], [69, 0.04], [71, 0.04], [64, 1.92], [68, 0.12], [71, 0.04], [72, 0.0], [64, 2.0], [76, 0.12], [75, 0.04], [76, 0.0], [75, 0.12], [76, 0.0], [71, 0.12], [74, 0.04], [72, 0.04], [69, 0.04], [60, 1.92], [64, 0.08], [69, 0.08], [71, 0.08], [62, 2.0], [72, 0.12], [71, 0.04], [69, 0.04], [60, 0.0], [71, 1.92], [72, 0.12], [74, 0.04], [76, 0.04], [67, 0.04], [77, 0.04], [76, 0.0], [74, 0.12], [65, 0.0], [76, 0.08], [74, 0.12], [72, 0.04], [64, 0.0], [74, 0.12], [72, 0.0], [71, 0.08], [64, 3.72], [76, 0.0], [76, 3.96], [88, 0.0], [75, 0.28], [76, 0.12], [75, 3.88], [76, 0.04], [75, 0.0], [76, 0.08], [75, 0.08], [76, 0.12], [71, 0.0], [74, 0.08], [72, 0.08], [69, 0.12], [60, 0.0], [64, 0.08], [69, 0.08], [71, 0.12], [64, 1.92], [68, 0.12], [71, 0.04], [72, 0.04], [64, 1.96], [76, 0.04], [75, 0.0], [76, 0.12], [75, 0.04], [76, 0.0], [71, 0.12], [74, 0.04], [72, 0.04], [69, 0.04], [60, 0.0], [64, 0.08], [69, 0.12], [71, 0.0], [62, 2.04], [72, 1.88], [71, 0.08], [69, 0.0], [60, 0.04], [70, 7.68], [64, 0.0], [73, 0.04], [67, 0.0], [74, 1.92], [65, 0.04], [69, 0.0], [73, 1.92], [76, 0.04], [77, 0.0], [74, 0.04], [68, 0.0], [74, 0.04], [77, 0.0], [68, 1.92], [74, 0.04], [77, 0.0], [72, 1.92], [76, 0.04], [69, 0.0], [74, 0.16], [65, 0.04], [72, 1.96], [64, 0.0], [71, 0.04], [62, 0.0], [60, 0.0], [69, 0.0], [66, 0.0], [69, 0.08], [60, 0.04], [60, 1.92], [69, 0.04], [72, 1.88], [64, 0.04], [62, 1.92], [71, 0.04], [60, 0.28], [69, 0.0], [64, 3.92], [67, 0.0], [73, 0.0], [70, 0.04], [69, 1.92], [74, 0.04], [65, 0.0], [76, 1.92], [73, 0.04], [77, 0.0], [74, 0.04], [77, 0.0], [74, 0.04], [77, 1.96], [74, 0.0], [77, 1.92], [74, 0.04], [67, 1.92], [75, 0.04], [65, 1.92], [74, 0.04], [72, 0.0], [63, 0.0], [70, 0.08], [65, 0.04], [62, 0.0], [69, 0.0], [65, 0.0], [62, 0.04], [68, 0.04], [65, 0.0], [62, 0.0], [62, 1.92], [65, 0.0], [68, 0.04], [69, 1.92], [60, 0.0], [64, 0.04], [64, 5.76], [71, 0.0], [57, 7.76], [60, 0.12], [64, 0.04], [69, 0.04], [72, 0.04], [76, 0.0], [74, 0.12], [72, 0.0], [71, 0.12], [69, 0.04], [72, 0.04], [76, 0.04], [81, 0.04], [84, 0.0], [88, 0.08], [86, 0.08], [84, 0.08], [83, 0.08], [81, 0.12], [84, 0.0], [88, 0.12], [93, 0.0], [96, 0.12], [100, 0.04], [98, 0.04], [96, 0.04], [95, 0.04], [94, 0.04], [93, 0.04], [92, 0.04], [91, 0.04], [90, 0.04], [89, 0.04], [88, 0.0], [87, 0.12], [86, 0.0], [85, 0.08], [84, 0.12], [83, 0.04], [82, 0.0], [81, 0.12], [80, 0.0], [79, 0.08], [78, 0.12], [77, 0.04], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.0], [74, 0.12], [72, 0.0], [69, 0.12], [60, 1.96], [64, 0.04], [69, 0.0], [71, 0.08], [64, 2.04], [68, 0.04], [71, 0.0], [72, 0.12], [64, 1.92], [76, 0.08], [75, 0.12], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.0], [74, 0.08], [72, 0.08], [69, 0.08], [60, 2.0], [64, 0.08], [69, 0.08], [71, 0.12], [62, 1.96], [72, 0.04], [71, 0.04], [60, 0.0], [69, 0.04], [71, 1.92], [72, 0.12], [74, 0.0], [76, 0.08], [67, 0.12], [77, 0.04], [76, 0.04], [74, 0.0], [65, 0.12], [76, 0.04], [74, 0.04], [72, 0.04], [64, 0.04], [74, 0.0], [72, 0.08], [71, 0.08], [64, 3.48], [76, 0.08], [76, 3.96], [88, 0.04], [75, 3.84], [76, 0.08], [75, 3.92], [76, 0.12], [75, 0.04], [76, 0.0], [75, 0.08], [76, 0.08], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.04], [60, 0.04], [64, 0.0], [69, 0.08], [71, 0.08], [64, 0.12], [68, 0.0], [71, 0.12], [72, 0.0], [64, 2.04], [76, 0.0], [75, 0.08], [76, 0.08], [75, 0.12], [76, 0.0], [71, 0.08], [74, 0.12], [72, 0.0], [69, 0.12], [60, 1.92], [64, 0.12], [69, 0.04], [71, 0.04], [62, 1.96], [72, 1.92], [71, 0.0], [60, 0.0], [69, 0.04]], [[45, 5.44], [52, 0.12], [57, 0.04], [40, 5.76], [52, 0.12], [56, 0.0], [45, 5.88], [52, 0.04], [57, 0.04], [45, 17.28], [52, 0.12], [57, 0.0], [40, 5.84], [52, 0.12], [56, 0.04], [45, 5.76], [52, 0.08], [57, 0.08], [45, 17.4], [52, 0.04], [57, 0.0], [40, 5.88], [52, 0.0], [56, 0.08], [45, 5.84], [52, 0.12], [57, 0.0], [45, 17.4], [52, 0.0], [57, 0.08], [40, 5.84], [52, 0.12], [56, 0.04], [45, 5.8], [52, 0.04], [57, 0.04], [48, 5.8], [55, 0.0], [60, 0.12], [43, 5.8], [55, 0.0], [59, 0.12], [45, 5.76], [52, 0.12], [57, 0.0], [40, 0.52], [52, 0.08], [64, 0.12], [64, 3.88], [76, 0.04], [75, 0.88], [76, 0.0], [75, 3.96], [76, 0.0], [45, 17.4], [52, 0.0], [57, 0.08], [40, 5.84], [52, 0.08], [56, 0.08], [45, 5.84], [52, 0.08], [57, 0.08], [45, 17.4], [52, 0.04], [57, 0.0], [40, 5.84], [52, 0.08], [56, 0.12], [45, 5.76], [52, 0.08], [57, 0.12], [48, 5.8], [55, 0.0], [60, 0.12], [43, 5.8], [55, 0.04], [59, 0.0], [45, 5.88], [52, 0.04], [57, 0.04], [40, 0.24], [52, 0.04], [64, 0.04], [64, 3.88], [76, 0.0], [75, 1.24], [76, 0.12], [75, 3.84], [76, 0.12], [45, 17.32], [52, 0.0], [57, 0.12], [40, 5.76], [52, 0.12], [56, 0.0], [45, 0.12], [52, 0.0], [57, 0.12], [45, 17.28], [52, 0.08], [57, 0.12], [40, 5.76], [52, 0.12], [56, 0.04], [45, 5.76], [52, 0.08], [57, 0.08], [60, 0.08], [58, 0.04], [57, 0.04], [60, 0.0], [60, 0.0], [55, 0.04], [58, 0.0], [53, 0.0], [57, 0.08], [60, 0.08], [57, 0.12], [60, 0.04], [57, 0.04], [53, 0.04], [58, 0.04], [62, 0.04], [58, 0.04], [62, 0.04], [58, 0.0], [53, 0.08], [62, 0.08], [53, 0.08], [58, 0.04], [55, 0.0], [62, 0.04], [58, 0.04], [55, 0.0], [53, 0.0], [62, 0.0], [53, 0.12], [57, 0.04], [60, 0.04], [57, 0.0], [60, 0.12], [57, 0.0], [53, 0.08], [57, 0.08], [60, 0.12], [57, 0.04], [60, 0.0], [57, 0.12], [52, 0.04], [57, 0.0], [60, 0.08], [57, 0.12], [50, 0.04], [62, 0.0], [53, 0.0], [55, 0.12], [64, 0.04], [55, 0.04], [64, 0.0], [55, 0.08], [65, 0.12], [60, 0.0], [64, 0.0], [67, 3.92], [65, 0.04], [64, 0.0], [67, 0.04], [62, 0.0], [67, 0.0], [65, 0.04], [60, 0.0], [64, 0.04], [67, 0.0], [57, 1.92], [53, 0.04], [59, 0.04], [55, 0.0], [60, 0.64], [67, 1.28], [65, 0.04], [64, 0.0], [67, 0.0], [65, 0.08], [62, 0.0], [67, 0.04], [67, 0.0], [60, 0.0], [64, 0.04], [53, 1.64], [57, 0.0], [59, 0.88], [55, 0.0], [59, 0.6], [56, 0.04], [75, 6.92], [76, 0.08], [75, 3.52], [76, 0.04], [45, 13.44], [52, 0.08], [57, 0.08], [40, 5.88], [52, 0.0], [56, 0.08], [45, 0.08], [52, 0.12], [57, 0.0], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.0], [56, 0.08], [45, 0.12], [52, 0.0], [57, 0.12], [48, 5.8], [55, 0.0], [60, 0.12], [43, 5.76], [55, 0.12], [59, 0.0], [45, 5.84], [52, 0.12], [57, 0.0], [40, 0.0], [52, 0.12], [64, 0.0], [64, 3.92], [76, 0.08], [75, 3.92], [76, 0.08], [75, 3.92], [76, 0.08], [45, 17.4], [52, 0.0], [57, 0.12], [40, 5.76], [52, 0.08], [56, 0.12], [45, 5.8], [52, 0.04], [57, 0.04], [45, 17.28], [52, 0.08], [57, 0.12], [40, 5.76], [52, 0.08], [56, 0.08], [45, 5.84], [45, 0.12], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.12], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.12], [45, 0.0], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [38, 0.0], [45, 0.04], [38, 0.0], [38, 0.0], [45, 0.04], [45, 0.04], [38, 0.0], [45, 0.0], [38, 0.04], [45, 0.0], [38, 0.04], [39, 0.04], [45, 0.0], [45, 0.0], [39, 0.04], [45, 0.04], [39, 0.0], [39, 0.0], [45, 0.0], [45, 0.08], [39, 0.04], [39, 0.0], [45, 0.0], [45, 0.08], [40, 0.0], [45, 0.12], [40, 0.0], [40, 0.0], [45, 0.04], [40, 0.0], [45, 0.04], [44, 0.0], [40, 0.0], [44, 0.12], [40, 0.0], [33, 0.0], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.0], [46, 0.08], [46, 0.12], [46, 0.0], [46, 0.08], [46, 0.12], [46, 0.04], [46, 0.04], [46, 0.0], [46, 0.12], [46, 0.0], [46, 0.08], [46, 0.08], [46, 0.12], [46, 0.0], [46, 0.08], [46, 0.08], [46, 0.12], [46, 0.04], [47, 0.0], [47, 0.08], [47, 0.12], [47, 0.0], [47, 0.12], [47, 0.0], [48, 0.08], [52, 7.76], [56, 0.0], [33, 7.8], [64, 2.68], [60, 0.0], [57, 0.0], [64, 0.04], [57, 0.0], [60, 0.0], [57, 5.76], [60, 0.0], [64, 0.04], [64, 1.92], [57, 0.0], [60, 0.0], [64, 5.84], [60, 0.0], [57, 0.04], [60, 1.76], [64, 0.0], [57, 0.04], [45, 32.48], [52, 0.12], [57, 0.04], [40, 5.76], [52, 0.12], [56, 0.0], [45, 5.84], [52, 0.08], [57, 0.08], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.76], [52, 0.12], [56, 0.0], [45, 5.88], [52, 0.04], [57, 0.04], [48, 5.8], [55, 0.04], [60, 0.04], [43, 0.04], [55, 0.04], [59, 0.0], [45, 5.84], [52, 0.08], [57, 0.08], [40, 5.84], [52, 0.12], [64, 0.0], [64, 3.92], [76, 0.12], [75, 3.84], [76, 0.12], [75, 3.88], [76, 0.04], [45, 17.32], [52, 0.0], [57, 0.12], [40, 5.8], [52, 0.0], [56, 0.12], [45, 5.76], [52, 0.08], [57, 0.12], [45, 17.28], [52, 0.08], [57, 0.12], [40, 5.76], [52, 0.08], [56, 0.08], [45, 0.4], [33, 0.04]], [[76, 0.08], [75, 0.12], [76, 0.0], [75, 0.08], [76, 0.08], [71, 0.08], [74, 0.12], [72, 0.04], [69, 0.0], [60, 2.0], [64, 0.12], [69, 0.04], [71, 0.0], [64, 2.04], [68, 0.04], [71, 0.0], [72, 0.08], [64, 2.0], [76, 0.08], [75, 0.08], [76, 0.08], [75, 0.12], [76, 0.0], [71, 0.08], [74, 0.12], [72, 0.0], [69, 0.08], [60, 2.04], [64, 0.0], [69, 0.12], [71, 0.0], [62, 0.08], [72, 1.96], [71, 0.0], [69, 0.08], [60, 0.04], [76, 3.88], [75, 0.0], [76, 0.12], [75, 0.0], [76, 0.12], [71, 0.04], [74, 0.0], [72, 0.08], [69, 0.08], [60, 2.0], [64, 0.08], [69, 0.12], [71, 0.04], [64, 1.92], [68, 0.08], [71, 0.12], [72, 0.04], [64, 1.92], [76, 0.08], [75, 0.12], [76, 0.04], [75, 0.04], [76, 0.0], [71, 0.08], [74, 0.08], [72, 0.08], [69, 0.08], [60, 2.0], [64, 0.12], [69, 0.0], [71, 0.08], [62, 2.0], [72, 1.92], [71, 0.08], [60, 0.08], [69, 0.0], [71, 2.0], [72, 0.08], [74, 0.08], [76, 0.12], [67, 0.04], [77, 0.04], [76, 0.0], [74, 0.12], [65, 0.0], [76, 0.08], [74, 0.08], [72, 0.12], [64, 0.0], [74, 0.12], [72, 0.0], [71, 0.08], [64, 3.96], [76, 0.04], [76, 3.88], [88, 0.04], [75, 3.84], [76, 0.08], [75, 3.92], [76, 0.12], [75, 0.04], [76, 0.04], [75, 0.04], [76, 0.0], [71, 0.12], [74, 0.0], [72, 0.08], [69, 0.12], [60, 1.92], [64, 0.08], [69, 0.08], [71, 0.12], [64, 1.96], [68, 0.0], [71, 0.08], [72, 0.12], [64, 1.92], [76, 0.08], [75, 0.12], [76, 0.0], [75, 0.12], [76, 0.0], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.04], [60, 1.96], [64, 0.04], [69, 0.0], [71, 0.08], [62, 2.04], [72, 1.88], [71, 0.12], [60, 0.0], [69, 0.04], [71, 1.92], [72, 0.08], [74, 0.08], [76, 0.08], [67, 0.08], [77, 0.12], [76, 0.04], [74, 0.04], [65, 0.0], [76, 0.12], [74, 0.04], [72, 0.04], [64, 0.04], [74, 0.04], [72, 0.0], [71, 0.08], [64, 2.96], [76, 1.08], [76, 3.84], [88, 1.08], [75, 4.8], [76, 1.08], [75, 3.84], [76, 1.04], [75, 0.12], [76, 1.0], [75, 0.0], [76, 0.08], [71, 0.12], [74, 0.0], [72, 0.08], [69, 1.08], [60, 2.92], [64, 0.04], [69, 0.04], [71, 0.0], [64, 2.04], [68, 0.04], [71, 0.0], [72, 0.08], [64, 2.0], [76, 1.08], [75, 0.04], [76, 0.0], [75, 0.08], [76, 0.08], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.0], [60, 2.96], [64, 0.08], [69, 0.12], [71, 0.04], [62, 1.96], [72, 0.0], [71, 0.08], [60, 1.04], [69, 0.04], [72, 2.92], [64, 0.0], [65, 0.96], [72, 0.0], [67, 1.04], [72, 0.04], [64, 0.0], [72, 1.0], [77, 0.96], [76, 0.12], [76, 0.0], [74, 0.08], [82, 1.04], [81, 0.12], [81, 0.04], [79, 0.04], [77, 0.0], [76, 0.08], [74, 0.08], [72, 0.08], [70, 0.08], [69, 0.08], [70, 0.08], [69, 0.12], [67, 0.04], [69, 0.0], [70, 0.12], [72, 0.04], [74, 0.0], [75, 0.08], [76, 0.12], [76, 0.96], [77, 0.08], [69, 0.08], [72, 1.08], [74, 1.0], [72, 0.04], [71, 0.0], [72, 0.12], [74, 0.04], [71, 0.0], [72, 0.12], [79, 0.04], [67, 0.04], [79, 0.0], [69, 0.08], [79, 0.12], [71, 0.04], [79, 0.0], [72, 0.12], [79, 0.04], [74, 0.0], [79, 0.12], [76, 0.0], [79, 0.08], [84, 0.12], [83, 0.04], [81, 0.0], [79, 0.12], [77, 0.04], [76, 0.0], [74, 0.08], [79, 0.08], [77, 0.12], [74, 0.0], [72, 0.12], [79, 0.04], [67, 0.0], [79, 0.12], [69, 0.0], [79, 0.08], [71, 0.08], [79, 0.08], [72, 0.08], [79, 0.08], [74, 0.08], [79, 0.12], [76, 0.0], [79, 0.08], [84, 0.12], [83, 0.04], [81, 0.04], [79, 0.0], [77, 0.12], [76, 0.0], [74, 0.08], [79, 0.12], [77, 0.0], [74, 0.12], [76, 0.04], [77, 0.0], [76, 0.08], [75, 0.08], [76, 0.12], [71, 0.04], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.04], [76, 0.04], [75, 0.0], [76, 0.08], [71, 0.12], [76, 0.0], [75, 0.08], [76, 0.12], [71, 0.0], [76, 0.08], [75, 3.96], [76, 0.0], [75, 3.92], [76, 0.12], [75, 0.04], [76, 0.0], [71, 0.08], [74, 0.12], [72, 0.0], [69, 0.12], [60, 1.92], [64, 0.12], [69, 0.0], [71, 0.12], [64, 1.92], [68, 0.08], [71, 0.08], [72, 0.08], [64, 2.04], [76, 0.04], [75, 0.0], [76, 0.08], [75, 0.12], [76, 0.0], [71, 0.12], [74, 0.0], [72, 0.12], [69, 0.0], [60, 2.04], [64, 0.04], [69, 0.04], [71, 0.0], [62, 2.04], [72, 0.04], [71, 0.0], [69, 0.12], [60, 0.0], [71, 1.92], [72, 0.12], [74, 0.0], [76, 0.08], [67, 0.12], [77, 0.04], [76, 0.0], [74, 0.12], [65, 0.0], [76, 0.08], [74, 0.12], [72, 0.0], [64, 0.08], [74, 0.08], [72, 0.12], [71, 0.0], [64, 3.92], [76, 0.08], [76, 3.96], [88, 0.04], [75, 3.88], [76, 0.04], [75, 3.84], [76, 0.08], [75, 0.12], [76, 0.0], [75, 0.08], [76, 0.08], [71, 0.08], [74, 0.08], [72, 0.12], [69, 0.0], [60, 0.08], [64, 0.12], [69, 0.04], [71, 0.04], [64, 1.92], [68, 0.12], [71, 0.0], [72, 0.12], [64, 1.92], [76, 0.12], [75, 0.04], [76, 0.0], [75, 0.12], [76, 0.0], [71, 0.12], [74, 0.04], [72, 0.04], [69, 0.0], [60, 0.08], [64, 0.12], [69, 0.04], [71, 0.0], [62, 2.04], [72, 1.92], [71, 0.0], [69, 0.0], [60, 0.04], [70, 7.68], [64, 0.04], [67, 0.0], [73, 0.0], [65, 1.92], [74, 0.04], [69, 0.0], [73, 1.92], [76, 0.0], [74, 0.08], [77, 0.0], [74, 0.08], [77, 0.04], [68, 0.0], [68, 1.96], [74, 0.0], [77, 0.0], [72, 1.92], [69, 0.04], [76, 0.0], [74, 1.92], [65, 0.0], [72, 2.04], [64, 0.0], [71, 0.0], [62, 0.0], [60, 0.08], [69, 0.04], [66, 0.0], [69, 0.0], [60, 0.04], [60, 1.92], [69, 0.04], [64, 1.92], [72, 0.04], [62, 1.92], [71, 0.04], [60, 1.92], [69, 0.04], [70, 3.84], [64, 0.04], [67, 0.0], [73, 0.0], [74, 1.92], [65, 0.0], [69, 0.04], [73, 1.92], [76, 0.04], [74, 0.04], [77, 0.0], [74, 0.04], [77, 0.0], [77, 1.96], [74, 0.0], [77, 1.96], [74, 0.0], [67, 1.92], [75, 0.04], [65, 1.92], [74, 0.04], [72, 0.0], [63, 0.04], [65, 0.04], [62, 0.0], [70, 0.0], [69, 0.0], [65, 0.0], [62, 0.04], [68, 0.0], [65, 0.0], [62, 0.04], [62, 1.92], [68, 0.04], [65, 0.0], [69, 1.92], [64, 0.0], [60, 0.04], [64, 5.76], [71, 0.04], [57, 7.68], [60, 0.08], [64, 0.08], [69, 0.08], [72, 0.08], [76, 0.08], [74, 0.08], [72, 0.08], [71, 0.08], [69, 0.12], [72, 0.04], [76, 0.04], [81, 0.0], [84, 0.08], [88, 0.08], [86, 0.12], [84, 0.04], [83, 0.0], [81, 0.12], [84, 0.04], [88, 0.04], [93, 0.04], [96, 0.04], [100, 0.0], [98, 0.08], [96, 0.12], [95, 0.04], [94, 0.04], [93, 0.0], [92, 0.12], [91, 0.0], [90, 0.12], [89, 0.04], [88, 0.04], [87, 0.0], [86, 0.08], [85, 0.08], [84, 0.08], [83, 0.12], [82, 0.0], [81, 0.08], [80, 0.08], [79, 0.12], [78, 0.04], [77, 0.0], [76, 0.08], [75, 0.12], [76, 0.04], [71, 0.04], [74, 0.04], [72, 0.0], [69, 0.12], [60, 1.96], [64, 0.04], [69, 0.04], [71, 0.0], [64, 2.04], [68, 0.04], [71, 0.04], [72, 0.04], [64, 1.96], [76, 0.0], [75, 0.12], [76, 0.04], [75, 0.0], [76, 0.08], [71, 0.12], [74, 0.04], [72, 0.04], [69, 0.04], [60, 1.92], [64, 0.12], [69, 0.04], [71, 0.04], [62, 1.92], [72, 0.12], [71, 0.04], [69, 0.04], [60, 0.0], [71, 1.92], [72, 0.08], [74, 0.08], [76, 0.08], [67, 0.12], [77, 0.04], [76, 0.0], [74, 0.08], [65, 0.12], [76, 0.0], [74, 0.08], [72, 0.12], [64, 0.04], [74, 0.0], [72, 0.08], [71, 0.12], [64, 3.88], [76, 0.04], [76, 3.88], [88, 0.04], [75, 3.84], [76, 0.12], [75, 3.88], [76, 0.04], [75, 0.0], [76, 0.08], [75, 0.12], [76, 0.04], [71, 0.0], [74, 0.12], [72, 0.0], [69, 0.08], [60, 0.08], [64, 0.08], [69, 0.08], [71, 0.08], [64, 0.12], [68, 0.04], [71, 0.0], [72, 0.12], [64, 1.96], [76, 0.04], [75, 0.0], [76, 0.08], [75, 0.08], [76, 0.12], [71, 0.04], [74, 0.0], [72, 0.08], [69, 0.08], [60, 2.04], [64, 0.0], [69, 0.08], [71, 0.08], [62, 2.04], [72, 1.88], [71, 0.12], [69, 0.04], [60, 0.0]], [[45, 15.48], [52, 0.0], [57, 0.08], [40, 5.88], [52, 0.0], [56, 0.12], [45, 5.8], [52, 0.04], [57, 0.04], [45, 17.32], [52, 0.0], [57, 0.08], [40, 5.88], [52, 0.04], [56, 0.0], [45, 5.88], [52, 0.0], [57, 0.08], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.76], [52, 0.08], [56, 0.08], [45, 5.84], [52, 0.12], [57, 0.04], [45, 17.28], [52, 0.08], [57, 0.08], [40, 5.88], [52, 0.04], [56, 0.0], [45, 5.88], [52, 0.04], [57, 0.0], [48, 5.84], [55, 0.12], [60, 0.04], [43, 5.8], [55, 0.0], [59, 0.12], [45, 5.8], [52, 0.04], [57, 0.0], [40, 5.84], [52, 0.12], [64, 0.04], [64, 3.88], [76, 0.0], [75, 3.92], [76, 0.12], [75, 3.84], [76, 0.12], [45, 17.28], [52, 0.12], [57, 0.04], [40, 5.76], [52, 0.08], [56, 0.08], [45, 5.88], [52, 0.04], [57, 0.04], [45, 17.28], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.04], [56, 0.04], [45, 5.76], [52, 0.08], [57, 0.08], [48, 5.88], [55, 0.0], [60, 0.08], [43, 5.84], [55, 0.12], [59, 0.04], [45, 5.76], [52, 0.08], [57, 0.08], [40, 5.88], [52, 0.0], [64, 0.12], [64, 3.88], [76, 0.0], [75, 3.96], [76, 0.0], [75, 3.92], [76, 0.08], [45, 17.4], [52, 0.04], [57, 0.0], [40, 5.84], [52, 0.12], [56, 0.04], [45, 5.8], [52, 0.04], [57, 0.0], [45, 17.36], [52, 0.08], [57, 0.12], [40, 5.76], [52, 0.08], [56, 0.08], [45, 5.84], [52, 0.12], [57, 0.0], [58, 0.12], [60, 0.0], [57, 0.04], [60, 0.0], [58, 0.04], [55, 0.0], [60, 0.0], [53, 0.0], [57, 0.08], [60, 0.08], [57, 0.12], [60, 0.04], [57, 0.04], [53, 0.0], [58, 0.08], [62, 0.08], [58, 0.12], [62, 0.0], [58, 0.12], [53, 0.0], [62, 0.12], [55, 0.04], [58, 0.0], [53, 0.0], [62, 0.04], [58, 0.0], [55, 0.04], [53, 0.0], [62, 0.0], [53, 0.08], [57, 0.08], [60, 0.08], [57, 0.12], [60, 0.0], [57, 0.12], [53, 0.04], [57, 0.04], [60, 0.04], [57, 0.04], [60, 0.0], [57, 0.12], [52, 0.04], [57, 0.0], [60, 0.08], [57, 0.08], [50, 0.12], [62, 0.0], [53, 0.04], [55, 0.0], [64, 0.08], [55, 0.08], [64, 0.08], [55, 0.12], [65, 0.04], [60, 0.04], [64, 0.0], [67, 3.88], [65, 0.0], [67, 0.0], [64, 0.0], [65, 0.08], [67, 0.0], [62, 0.0], [67, 0.08], [64, 0.04], [60, 0.0], [57, 1.92], [53, 0.04], [59, 0.0], [55, 0.04], [60, 1.92], [67, 3.92], [65, 0.04], [67, 0.0], [64, 0.04], [67, 0.0], [62, 0.0], [65, 0.04], [64, 0.0], [67, 0.04], [60, 0.0], [53, 1.96], [57, 0.0], [59, 1.92], [55, 0.0], [59, 2.04], [56, 0.0], [75, 28.84], [76, 0.04], [75, 3.88], [76, 0.0], [45, 13.52], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.04], [56, 0.04], [45, 5.76], [52, 0.12], [57, 0.0], [45, 17.4], [52, 0.0], [57, 0.12], [40, 5.76], [52, 0.08], [56, 0.08], [45, 5.84], [52, 0.08], [57, 0.08], [48, 5.84], [55, 0.12], [60, 0.0], [43, 5.84], [55, 0.12], [59, 0.0], [45, 5.88], [52, 0.0], [57, 0.12], [40, 5.8], [52, 0.04], [64, 0.04], [64, 3.84], [76, 0.08], [75, 3.96], [76, 0.04], [75, 3.88], [76, 0.04], [45, 17.32], [52, 0.04], [57, 0.04], [40, 5.76], [52, 0.12], [56, 0.04], [45, 5.8], [52, 0.04], [57, 0.04], [45, 17.32], [52, 0.04], [57, 0.0], [40, 5.88], [52, 0.04], [56, 0.04], [45, 5.76], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.0], [45, 0.08], [38, 0.04], [38, 0.0], [45, 0.04], [38, 0.0], [45, 0.0], [45, 0.08], [38, 0.0], [45, 0.08], [38, 0.0], [38, 0.08], [45, 0.04], [39, 0.0], [45, 0.04], [45, 0.0], [39, 0.0], [39, 0.08], [45, 0.04], [45, 0.0], [39, 0.04], [45, 0.04], [39, 0.0], [39, 0.04], [45, 0.0], [45, 0.0], [40, 0.0], [45, 0.08], [40, 0.04], [40, 0.04], [45, 0.0], [45, 0.0], [40, 0.04], [40, 0.0], [44, 0.04], [44, 0.0], [40, 0.0], [33, 0.12], [45, 0.0], [45, 0.0], [45, 0.0], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.12], [45, 0.04], [45, 0.0], [45, 0.12], [45, 0.0], [45, 0.12], [45, 0.04], [45, 0.0], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.08], [45, 0.08], [46, 0.12], [46, 0.0], [46, 0.12], [46, 0.04], [46, 0.04], [46, 0.04], [46, 0.04], [46, 0.04], [46, 0.0], [46, 0.08], [46, 0.12], [46, 0.04], [46, 0.0], [46, 0.08], [46, 0.12], [46, 0.0], [46, 0.08], [46, 0.12], [47, 0.04], [47, 0.04], [47, 0.04], [47, 0.04], [47, 0.04], [47, 0.04], [48, 0.04], [52, 7.68], [56, 0.04], [33, 7.68], [57, 3.92], [64, 0.04], [60, 0.0], [64, 0.0], [60, 0.0], [57, 0.04], [57, 5.76], [60, 0.0], [64, 0.04], [64, 1.92], [57, 0.0], [60, 0.04], [64, 5.76], [57, 0.04], [60, 0.0], [57, 1.92], [64, 0.0], [60, 0.0], [45, 32.72], [52, 0.12], [57, 0.0], [40, 5.88], [52, 0.0], [56, 0.12], [45, 5.8], [52, 0.0], [57, 0.08], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.04], [56, 0.04], [45, 5.76], [52, 0.12], [57, 0.04], [48, 5.8], [55, 0.04], [60, 0.04], [43, 5.76], [55, 0.08], [59, 0.12], [45, 5.8], [52, 0.04], [57, 0.04], [40, 5.8], [52, 0.0], [64, 0.08], [64, 3.92], [76, 0.12], [75, 3.84], [76, 0.08], [75, 3.96], [76, 0.0], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.0], [56, 0.12], [45, 5.76], [52, 0.08], [57, 0.08], [45, 17.36], [52, 0.12], [57, 0.04], [40, 5.8], [52, 0.04], [56, 0.0], [33, 5.84], [45, 0.04]]]

song_array = [song_array[3]]
shift = -70
for ix in range(len(song_array)):
    for iy in range(len(song_array[ix])):
        if len(song_array[ix][iy]) == 2:
            song_array[ix][iy] = [song_array[ix][iy][0] + shift, song_array[ix][iy][1]]

# end midi experiment --------------------------------------------------------------------------

sound_signal = make_song_from_array(notes, song_array, samples_between_notes)

soundfile.write('sound_test/output.wav', sound_signal, sample_rate)
print('Done! ' + str(datetime.now()))
x = 2
